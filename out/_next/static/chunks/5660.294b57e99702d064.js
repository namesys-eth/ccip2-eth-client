(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5660],{21429:function(t){t.exports=function t(r,e,n){function i(s,a){if(!e[s]){if(!r[s]){if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var f=e[s]={exports:{}};r[s][0].call(f.exports,(function(t){var e=r[s][1][t];return i(e||t)}),f,f.exports,t,r,e,n)}return e[s].exports}for(var o=void 0,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,r,e){var n;function o(t,r,e){null!=t&&("number"==typeof t?this.fromNumber(t,r,e):null==r&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,r))}function s(){return new o(null)}function a(t,r,e,n,i,o){for(var s=32767&r,a=r>>15;--o>=0;){var f=32767&this[t],u=this[t++]>>15,h=a*f+u*s;i=((f=s*f+((32767&h)<<15)+e[n]+(1073741823&i))>>>30)+(h>>>15)+a*u+(i>>>30),e[n++]=1073741823&f}return i}o.prototype.am=a,n=30,o.prototype.DB=n,o.prototype.DM=(1<<n)-1,o.prototype.DV=1<<n;var f=52;o.prototype.FV=Math.pow(2,f),o.prototype.F1=f-n,o.prototype.F2=2*n-f;var u,h,c="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array;for(u="0".charCodeAt(0),h=0;h<=9;++h)l[u++]=h;for(u="a".charCodeAt(0),h=10;h<36;++h)l[u++]=h;for(u="A".charCodeAt(0),h=10;h<36;++h)l[u++]=h;function p(t){return c.charAt(t)}function d(t,r){var e=l[t.charCodeAt(r)];return null==e?-1:e}function y(t){for(var r=this.t-1;r>=0;--r)t[r]=this[r];t.t=this.t,t.s=this.s}function g(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0}function m(t){var r=s();return r.fromInt(t),r}function w(t,r){var e;if(16==r)e=4;else if(8==r)e=3;else if(256==r)e=8;else if(2==r)e=1;else if(32==r)e=5;else{if(4!=r)return void this.fromRadix(t,r);e=2}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var a=8==e?255&t[n]:d(t,n);a<0?"-"==t.charAt(n)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+e>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=e)>=this.DB&&(s-=this.DB))}8==e&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&o.ZERO.subTo(this,this)}function b(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function E(t){if(this.s<0)return"-"+this.negate().toString(t);var r;if(16==t)r=4;else if(8==t)r=3;else if(2==t)r=1;else if(32==t)r=5;else if(64==t)r=6;else{if(4!=t)return this.toRadix(t);r=2}var e,n=(1<<r)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%r;if(s-- >0)for(a<this.DB&&(e=this[s]>>a)>0&&(i=!0,o=p(e));s>=0;)a<r?(e=(this[s]&(1<<a)-1)<<r-a,e|=this[--s]>>(a+=this.DB-r)):(e=this[s]>>(a-=r)&n,a<=0&&(a+=this.DB,--s)),e>0&&(i=!0),i&&(o+=p(e));return i?o:"0"}function S(){var t=s();return o.ZERO.subTo(this,t),t}function x(){return this.s<0?this.negate():this}function B(t){var r=this.s-t.s;if(0!=r)return r;var e=this.t;if(0!=(r=e-t.t))return r;for(;--e>=0;)if(0!=(r=this[e]-t[e]))return r;return 0}function A(t){var r,e=1;return 0!=(r=t>>>16)&&(t=r,e+=16),0!=(r=t>>8)&&(t=r,e+=8),0!=(r=t>>4)&&(t=r,e+=4),0!=(r=t>>2)&&(t=r,e+=2),0!=(r=t>>1)&&(t=r,e+=1),e}function T(){return this.t<=0?0:this.DB*(this.t-1)+A(this[this.t-1]^this.s&this.DM)}function I(t,r){var e;for(e=this.t-1;e>=0;--e)r[e+t]=this[e];for(e=t-1;e>=0;--e)r[e]=0;r.t=this.t+t,r.s=this.s}function R(t,r){for(var e=t;e<this.t;++e)r[e-t]=this[e];r.t=Math.max(this.t-t,0),r.s=this.s}function D(t,r){var e,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(e=this.t-1;e>=0;--e)r[e+s+1]=this[e]>>i|a,a=(this[e]&o)<<n;for(e=s-1;e>=0;--e)r[e]=0;r[s]=a,r.t=this.t+s+1,r.s=this.s,r.clamp()}function U(t,r){r.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)r.t=0;else{var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;r[0]=this[e]>>n;for(var s=e+1;s<this.t;++s)r[s-e-1]|=(this[s]&o)<<i,r[s-e]=this[s]>>n;n>0&&(r[this.t-e-1]|=(this.s&o)<<i),r.t=this.t-e,r.clamp()}}function L(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);e<i;)n+=this[e]-t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n-=t[e],r[e++]=n&this.DM,n>>=this.DB;n-=t.s}r.s=n<0?-1:0,n<-1?r[e++]=this.DV+n:n>0&&(r[e++]=n),r.t=e,r.clamp()}function O(t,r){var e=this.abs(),n=t.abs(),i=e.t;for(r.t=i+n.t;--i>=0;)r[i]=0;for(i=0;i<n.t;++i)r[i+e.t]=e.am(0,n[i],r,i,0,e.t);r.s=0,r.clamp(),this.s!=t.s&&o.ZERO.subTo(r,r)}function N(t){for(var r=this.abs(),e=t.t=2*r.t;--e>=0;)t[e]=0;for(e=0;e<r.t-1;++e){var n=r.am(e,r[e],t,2*e,0,1);(t[e+r.t]+=r.am(e+1,2*r[e],t,2*e+1,n,r.t-e-1))>=r.DV&&(t[e+r.t]-=r.DV,t[e+r.t+1]=1)}t.t>0&&(t[t.t-1]+=r.am(e,r[e],t,2*e,0,1)),t.s=0,t.clamp()}function P(t,r,e){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=r&&r.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=s());var a=s(),f=this.s,u=t.s,h=this.DB-A(n[n.t-1]);h>0?(n.lShiftTo(h,a),i.lShiftTo(h,e)):(n.copyTo(a),i.copyTo(e));var c=a.t,l=a[c-1];if(0!=l){var p=l*(1<<this.F1)+(c>1?a[c-2]>>this.F2:0),d=this.FV/p,y=(1<<this.F1)/p,g=1<<this.F2,v=e.t,m=v-c,w=null==r?s():r;for(a.dlShiftTo(m,w),e.compareTo(w)>=0&&(e[e.t++]=1,e.subTo(w,e)),o.ONE.dlShiftTo(c,w),w.subTo(a,a);a.t<c;)a[a.t++]=0;for(;--m>=0;){var b=e[--v]==l?this.DM:Math.floor(e[v]*d+(e[v-1]+g)*y);if((e[v]+=a.am(0,b,e,m,0,c))<b)for(a.dlShiftTo(m,w),e.subTo(w,e);e[v]<--b;)e.subTo(w,e)}null!=r&&(e.drShiftTo(c,r),f!=u&&o.ZERO.subTo(r,r)),e.t=c,e.clamp(),h>0&&e.rShiftTo(h,e),f<0&&o.ZERO.subTo(e,e)}}}function C(t){var r=s();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(o.ZERO)>0&&t.subTo(r,r),r}function M(t){this.m=t}function _(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function k(t){return t}function q(t){t.divRemTo(this.m,null,t)}function H(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function F(t,r){t.squareTo(r),this.reduce(r)}function Z(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var r=3&t;return(r=(r=(r=(r=r*(2-(15&t)*r)&15)*(2-(255&t)*r)&255)*(2-((65535&t)*r&65535))&65535)*(2-t*r%this.DV)%this.DV)>0?this.DV-r:-r}function z(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function V(t){var r=s();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(o.ZERO)>0&&this.m.subTo(r,r),r}function j(t){var r=s();return t.copyTo(r),this.reduce(r),r}function K(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var r=0;r<this.m.t;++r){var e=32767&t[r],n=e*this.mpl+((e*this.mph+(t[r]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[e=r+this.m.t]+=this.m.am(0,n,t,r,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function W(t,r){t.squareTo(r),this.reduce(r)}function G(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function $(){return 0==(this.t>0?1&this[0]:this.s)}function J(t,r){if(t>4294967295||t<1)return o.ONE;var e=s(),n=s(),i=r.convert(this),a=A(t)-1;for(i.copyTo(e);--a>=0;)if(r.sqrTo(e,n),(t&1<<a)>0)r.mulTo(n,i,e);else{var f=e;e=n,n=f}return r.revert(e)}function X(t,r){var e;return e=t<256||r.isEven()?new M(r):new z(r),this.exp(t,e)}function Y(){var t=s();return this.copyTo(t),t}function Q(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function tt(){return 0==this.t?this.s:this[0]<<24>>24}function rt(){return 0==this.t?this.s:this[0]<<16>>16}function et(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function nt(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function it(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var r=this.chunkSize(t),e=Math.pow(t,r),n=m(e),i=s(),o=s(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(e+o.intValue()).toString(t).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(t)+a}function ot(t,r){this.fromInt(0),null==r&&(r=10);for(var e=this.chunkSize(r),n=Math.pow(r,e),i=!1,s=0,a=0,f=0;f<t.length;++f){var u=d(t,f);u<0?"-"==t.charAt(f)&&0==this.signum()&&(i=!0):(a=r*a+u,++s>=e&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(r,s)),this.dAddOffset(a,0)),i&&o.ZERO.subTo(this,this)}function st(t,r,e){if("number"==typeof r)if(t<2)this.fromInt(1);else for(this.fromNumber(t,e),this.testBit(t-1)||this.bitwiseTo(o.ONE.shiftLeft(t-1),dt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(o.ONE.shiftLeft(t-1),this);else{var n=new Array,i=7&t;n.length=1+(t>>3),r.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function at(){var t=this.t,r=new Array;r[0]=this.s;var e,n=this.DB-t*this.DB%8,i=0;if(t-- >0)for(n<this.DB&&(e=this[t]>>n)!=(this.s&this.DM)>>n&&(r[i++]=e|this.s<<this.DB-n);t>=0;)n<8?(e=(this[t]&(1<<n)-1)<<8-n,e|=this[--t]>>(n+=this.DB-8)):(e=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==i&&(128&this.s)!=(128&e)&&++i,(i>0||e!=this.s)&&(r[i++]=e);return r}function ft(t){return 0==this.compareTo(t)}function ut(t){return this.compareTo(t)<0?this:t}function ht(t){return this.compareTo(t)>0?this:t}function ct(t,r,e){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)e[n]=r(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)e[n]=r(this[n],i);e.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)e[n]=r(i,t[n]);e.t=t.t}e.s=r(this.s,t.s),e.clamp()}function lt(t,r){return t&r}function pt(t){var r=s();return this.bitwiseTo(t,lt,r),r}function dt(t,r){return t|r}function yt(t){var r=s();return this.bitwiseTo(t,dt,r),r}function gt(t,r){return t^r}function vt(t){var r=s();return this.bitwiseTo(t,gt,r),r}function mt(t,r){return t&~r}function wt(t){var r=s();return this.bitwiseTo(t,mt,r),r}function bt(){for(var t=s(),r=0;r<this.t;++r)t[r]=this.DM&~this[r];return t.t=this.t,t.s=~this.s,t}function Et(t){var r=s();return t<0?this.rShiftTo(-t,r):this.lShiftTo(t,r),r}function St(t){var r=s();return t<0?this.lShiftTo(-t,r):this.rShiftTo(t,r),r}function xt(t){if(0==t)return-1;var r=0;return 0==(65535&t)&&(t>>=16,r+=16),0==(255&t)&&(t>>=8,r+=8),0==(15&t)&&(t>>=4,r+=4),0==(3&t)&&(t>>=2,r+=2),0==(1&t)&&++r,r}function Bt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+xt(this[t]);return this.s<0?this.t*this.DB:-1}function At(t){for(var r=0;0!=t;)t&=t-1,++r;return r}function Tt(){for(var t=0,r=this.s&this.DM,e=0;e<this.t;++e)t+=At(this[e]^r);return t}function It(t){var r=Math.floor(t/this.DB);return r>=this.t?0!=this.s:0!=(this[r]&1<<t%this.DB)}function Rt(t,r){var e=o.ONE.shiftLeft(t);return this.bitwiseTo(e,r,e),e}function Dt(t){return this.changeBit(t,dt)}function Ut(t){return this.changeBit(t,mt)}function Lt(t){return this.changeBit(t,gt)}function Ot(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);e<i;)n+=this[e]+t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n+=t[e],r[e++]=n&this.DM,n>>=this.DB;n+=t.s}r.s=n<0?-1:0,n>0?r[e++]=n:n<-1&&(r[e++]=this.DV+n),r.t=e,r.clamp()}function Nt(t){var r=s();return this.addTo(t,r),r}function Pt(t){var r=s();return this.subTo(t,r),r}function Ct(t){var r=s();return this.multiplyTo(t,r),r}function Mt(){var t=s();return this.squareTo(t),t}function _t(t){var r=s();return this.divRemTo(t,r,null),r}function kt(t){var r=s();return this.divRemTo(t,null,r),r}function qt(t){var r=s(),e=s();return this.divRemTo(t,r,e),new Array(r,e)}function Ht(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ft(t,r){if(0!=t){for(;this.t<=r;)this[this.t++]=0;for(this[r]+=t;this[r]>=this.DV;)this[r]-=this.DV,++r>=this.t&&(this[this.t++]=0),++this[r]}}function Zt(){}function zt(t){return t}function Vt(t,r,e){t.multiplyTo(r,e)}function jt(t,r){t.squareTo(r)}function Kt(t){return this.exp(t,new Zt)}function Wt(t,r,e){var n,i=Math.min(this.t+t.t,r);for(e.s=0,e.t=i;i>0;)e[--i]=0;for(n=e.t-this.t;i<n;++i)e[i+this.t]=this.am(0,t[i],e,i,0,this.t);for(n=Math.min(t.t,r);i<n;++i)this.am(0,t[i],e,i,0,r-i);e.clamp()}function Gt(t,r,e){--r;var n=e.t=this.t+t.t-r;for(e.s=0;--n>=0;)e[n]=0;for(n=Math.max(r-this.t,0);n<t.t;++n)e[this.t+n-r]=this.am(r-n,t[n],e,0,0,this.t+n-r);e.clamp(),e.drShiftTo(1,e)}function $t(t){this.r2=s(),this.q3=s(),o.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Jt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var r=s();return t.copyTo(r),this.reduce(r),r}function Xt(t){return t}function Yt(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Qt(t,r){t.squareTo(r),this.reduce(r)}function tr(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function rr(t,r){var e,n,i=t.bitLength(),o=m(1);if(i<=0)return o;e=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new M(r):r.isEven()?new $t(r):new z(r);var a=new Array,f=3,u=e-1,h=(1<<e)-1;if(a[1]=n.convert(this),e>1){var c=s();for(n.sqrTo(a[1],c);f<=h;)a[f]=s(),n.mulTo(c,a[f-2],a[f]),f+=2}var l,p,d=t.t-1,y=!0,g=s();for(i=A(t[d])-1;d>=0;){for(i>=u?l=t[d]>>i-u&h:(l=(t[d]&(1<<i+1)-1)<<u-i,d>0&&(l|=t[d-1]>>this.DB+i-u)),f=e;0==(1&l);)l>>=1,--f;if((i-=f)<0&&(i+=this.DB,--d),y)a[l].copyTo(o),y=!1;else{for(;f>1;)n.sqrTo(o,g),n.sqrTo(g,o),f-=2;f>0?n.sqrTo(o,g):(p=o,o=g,g=p),n.mulTo(g,a[l],o)}for(;d>=0&&0==(t[d]&1<<i);)n.sqrTo(o,g),p=o,o=g,g=p,--i<0&&(i=this.DB-1,--d)}return n.revert(o)}function er(t){var r=this.s<0?this.negate():this.clone(),e=t.s<0?t.negate():t.clone();if(r.compareTo(e)<0){var n=r;r=e,e=n}var i=r.getLowestSetBit(),o=e.getLowestSetBit();if(o<0)return r;for(i<o&&(o=i),o>0&&(r.rShiftTo(o,r),e.rShiftTo(o,e));r.signum()>0;)(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),r.compareTo(e)>=0?(r.subTo(e,r),r.rShiftTo(1,r)):(e.subTo(r,e),e.rShiftTo(1,e));return o>0&&e.lShiftTo(o,e),e}function nr(t){if(t<=0)return 0;var r=this.DV%t,e=this.s<0?t-1:0;if(this.t>0)if(0==r)e=this[0]%t;else for(var n=this.t-1;n>=0;--n)e=(r*e+this[n])%t;return e}function ir(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return o.ZERO;for(var e=t.clone(),n=this.clone(),i=m(1),s=m(0),a=m(0),f=m(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),r?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),r?(a.isEven()&&f.isEven()||(a.addTo(this,a),f.subTo(t,f)),a.rShiftTo(1,a)):f.isEven()||f.subTo(t,f),f.rShiftTo(1,f);e.compareTo(n)>=0?(e.subTo(n,e),r&&i.subTo(a,i),s.subTo(f,s)):(n.subTo(e,n),r&&a.subTo(i,a),f.subTo(s,f))}return 0!=n.compareTo(o.ONE)?o.ZERO:f.compareTo(t)>=0?f.subtract(t):f.signum()<0?(f.addTo(t,f),f.signum()<0?f.add(t):f):f}M.prototype.convert=_,M.prototype.revert=k,M.prototype.reduce=q,M.prototype.mulTo=H,M.prototype.sqrTo=F,z.prototype.convert=V,z.prototype.revert=j,z.prototype.reduce=K,z.prototype.mulTo=G,z.prototype.sqrTo=W,o.prototype.copyTo=y,o.prototype.fromInt=g,o.prototype.fromString=w,o.prototype.clamp=b,o.prototype.dlShiftTo=I,o.prototype.drShiftTo=R,o.prototype.lShiftTo=D,o.prototype.rShiftTo=U,o.prototype.subTo=L,o.prototype.multiplyTo=O,o.prototype.squareTo=N,o.prototype.divRemTo=P,o.prototype.invDigit=Z,o.prototype.isEven=$,o.prototype.exp=J,o.prototype.toString=E,o.prototype.negate=S,o.prototype.abs=x,o.prototype.compareTo=B,o.prototype.bitLength=T,o.prototype.mod=C,o.prototype.modPowInt=X,o.ZERO=m(0),o.ONE=m(1),Zt.prototype.convert=zt,Zt.prototype.revert=zt,Zt.prototype.mulTo=Vt,Zt.prototype.sqrTo=jt,$t.prototype.convert=Jt,$t.prototype.revert=Xt,$t.prototype.reduce=Yt,$t.prototype.mulTo=tr,$t.prototype.sqrTo=Qt;var or=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],sr=(1<<26)/or[or.length-1];function ar(t){var r,e=this.abs();if(1==e.t&&e[0]<=or[or.length-1]){for(r=0;r<or.length;++r)if(e[0]==or[r])return!0;return!1}if(e.isEven())return!1;for(r=1;r<or.length;){for(var n=or[r],i=r+1;i<or.length&&n<sr;)n*=or[i++];for(n=e.modInt(n);r<i;)if(n%or[r++]==0)return!1}return e.millerRabin(t)}function fr(t){var r=this.subtract(o.ONE),e=r.getLowestSetBit();if(e<=0)return!1;var n=r.shiftRight(e);(t=t+1>>1)>or.length&&(t=or.length);for(var i=s(),a=0;a<t;++a){i.fromInt(or[Math.floor(Math.random()*or.length)]);var f=i.modPow(n,this);if(0!=f.compareTo(o.ONE)&&0!=f.compareTo(r)){for(var u=1;u++<e&&0!=f.compareTo(r);)if(0==(f=f.modPowInt(2,this)).compareTo(o.ONE))return!1;if(0!=f.compareTo(r))return!1}}return!0}function ur(){}function hr(t){var r;for(r=0;r<t.length;r++)t[r]=Math.floor(256*Math.random())}function cr(){this.i=0,this.j=0,this.S=new Array}function lr(t){var r,e,n;for(r=0;r<256;++r)this.S[r]=r;for(e=0,r=0;r<256;++r)e=e+this.S[r]+t[r%t.length]&255,n=this.S[r],this.S[r]=this.S[e],this.S[e]=n;this.i=0,this.j=0}function pr(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function dr(){return new cr}o.prototype.chunkSize=et,o.prototype.toRadix=it,o.prototype.fromRadix=ot,o.prototype.fromNumber=st,o.prototype.bitwiseTo=ct,o.prototype.changeBit=Rt,o.prototype.addTo=Ot,o.prototype.dMultiply=Ht,o.prototype.dAddOffset=Ft,o.prototype.multiplyLowerTo=Wt,o.prototype.multiplyUpperTo=Gt,o.prototype.modInt=nr,o.prototype.millerRabin=fr,o.prototype.clone=Y,o.prototype.intValue=Q,o.prototype.byteValue=tt,o.prototype.shortValue=rt,o.prototype.signum=nt,o.prototype.toByteArray=at,o.prototype.equals=ft,o.prototype.min=ut,o.prototype.max=ht,o.prototype.and=pt,o.prototype.or=yt,o.prototype.xor=vt,o.prototype.andNot=wt,o.prototype.not=bt,o.prototype.shiftLeft=Et,o.prototype.shiftRight=St,o.prototype.getLowestSetBit=Bt,o.prototype.bitCount=Tt,o.prototype.testBit=It,o.prototype.setBit=Dt,o.prototype.clearBit=Ut,o.prototype.flipBit=Lt,o.prototype.add=Nt,o.prototype.subtract=Pt,o.prototype.multiply=Ct,o.prototype.divide=_t,o.prototype.remainder=kt,o.prototype.divideAndRemainder=qt,o.prototype.modPow=rr,o.prototype.modInverse=ir,o.prototype.pow=Kt,o.prototype.gcd=er,o.prototype.isProbablePrime=ar,o.prototype.square=Mt,function(t,r,e,n,i,o,s){function a(t){var r,n,i=this,o=t.length,s=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(t=[o++]);s<e;)i.S[s]=s++;for(s=0;s<e;s++)a=h(a+(r=i.S[s])+t[s%o]),n=i.S[a],i.S[s]=n,i.S[a]=r;i.g=function(t){var r=i.S,n=h(i.i+1),o=r[n],s=h(i.j+o),a=r[s];r[n]=a,r[s]=o;for(var f=r[h(o+a)];--t;)n=h(n+1),a=r[s=h(s+(o=r[n]))],r[n]=a,r[s]=o,f=f*e+r[h(o+a)];return i.i=n,i.j=s,f},i.g(e)}function f(t,r,e,n,i){if(e=[],i=typeof t,r&&"object"==i)for(n in t)if(n.indexOf("S")<5)try{e.push(f(t[n],r-1))}catch(o){}return e.length?e:t+("string"!=i?"\0":"")}function u(t,r,e,n){for(t+="",e=0,n=0;n<t.length;n++)r[h(n)]=h((e^=19*r[h(n)])+t.charCodeAt(n));for(n in t="",r)t+=String.fromCharCode(r[n]);return t}function h(t){return t&e-1}r.seedrandom=function(h,c){var l,p=[];return h=u(f(c?[h,t]:arguments.length?h:[(new Date).getTime(),t],3),p),u((l=new a(p)).S,t),r.random=function(){for(var t=l.g(n),r=s,a=0;t<i;)t=(t+a)*e,r*=e,a=l.g(1);for(;t>=o;)t/=2,r/=2,a>>>=1;return(t+a)/r},h},s=r.pow(e,n),i=r.pow(2,i),o=2*i,u(r.random(),t)}([],Math,256,6,52),ur.prototype.nextBytes=hr,cr.prototype.init=lr,cr.prototype.next=pr;var yr,gr,vr,mr=256;function wr(t){gr[vr++]^=255&t,gr[vr++]^=t>>8&255,gr[vr++]^=t>>16&255,gr[vr++]^=t>>24&255,vr>=mr&&(vr-=mr)}function br(){wr((new Date).getTime())}if(null==gr){var Er;for(gr=new Array,vr=0;vr<mr;)Er=Math.floor(65536*Math.random()),gr[vr++]=Er>>>8,gr[vr++]=255&Er;vr=0,br()}function Sr(){if(null==yr){for(br(),(yr=dr()).init(gr),vr=0;vr<gr.length;++vr)gr[vr]=0;vr=0}return yr.next()}function xr(t){var r;for(r=0;r<t.length;++r)t[r]=Sr()}function Br(){}Br.prototype.nextBytes=xr;var Ar=t("crypto");function Tr(t){return Ar.createHash("sha256").update(t,"utf8").digest("hex")}var Ir={};function Rr(t){return Ar.createHash("sha1").update(t,"utf8").digest("hex")}Ir.hex=function(t){return Tr(t)};var Dr={hex:function(t){return Rr(t)}},Ur=function(t){return Ar.createHash("md5").update(t,"utf8").digest("hex")};function Lr(t,r){return new o(t,r)}function Or(t,r){if(r<t.length+11)throw"Message too long for RSA (n="+r+", l="+t.length+")";for(var e=new Array,n=t.length-1;n>=0&&r>0;){var i=t.charCodeAt(n--);i<128?e[--r]=i:i>127&&i<2048?(e[--r]=63&i|128,e[--r]=i>>6|192):(e[--r]=63&i|128,e[--r]=i>>6&63|128,e[--r]=i>>12|224)}e[--r]=0;for(var s=new Br,a=new Array;r>2;){for(a[0]=0;0==a[0];)s.nextBytes(a);e[--r]=a[0]}return e[--r]=2,e[--r]=0,new o(e)}function Nr(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Pr(t,r){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=Lr(t,16),this.e=parseInt(r,16)):alert("Invalid RSA public key")}function Cr(t){return t.modPowInt(this.e,this.n)}function Mr(t){var r=Or(t,this.n.bitLength()+7>>3);if(null==r)return null;var e=this.doPublic(r);if(null==e)return null;var n=e.toString(16);return 0==(1&n.length)?n:"0"+n}function _r(){return{coeff:this.coeff.toString(16),d:this.d.toString(16),dmp1:this.dmp1.toString(16),dmq1:this.dmq1.toString(16),e:this.e.toString(16),n:this.n.toString(16),p:this.p.toString(16),q:this.q.toString(16)}}function kr(t){var r=JSON.parse(t),e=new Nr;return e.setPrivateEx(r.n,r.e,r.d,r.p,r.q,r.dmp1,r.dmq1,r.coeff),e}function qr(t,r){for(var e=t.toByteArray(),n=0;n<e.length&&0==e[n];)++n;if(e.length-n!=r-1||2!=e[n])return null;for(++n;0!=e[n];)if(++n>=e.length)return null;for(var i="";++n<e.length;){var o=255&e[n];o<128?i+=String.fromCharCode(o):o>191&&o<224?(i+=String.fromCharCode((31&o)<<6|63&e[n+1]),++n):(i+=String.fromCharCode((15&o)<<12|(63&e[n+1])<<6|63&e[n+2]),n+=2)}return i}function Hr(t,r,e){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=Lr(t,16),this.e=parseInt(r,16),this.d=Lr(e,16)):alert("Invalid RSA private key")}function Fr(t,r,e,n,i,o,s,a){if(!(null!=t&&null!=r&&t.length>0&&r.length>0))throw new Error("Invalid RSA private key");this.n=Lr(t,16),this.e=parseInt(r,16),this.d=Lr(e,16),this.p=Lr(n,16),this.q=Lr(i,16),this.dmp1=Lr(o,16),this.dmq1=Lr(s,16),this.coeff=Lr(a,16)}function Zr(t,r){var e=new ur,n=t>>1;this.e=parseInt(r,16);for(var i=new o(r,16);;){for(;this.p=new o(t-n,1,e),0!=this.p.subtract(o.ONE).gcd(i).compareTo(o.ONE)||!this.p.isProbablePrime(10););for(;this.q=new o(n,1,e),0!=this.q.subtract(o.ONE).gcd(i).compareTo(o.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var a=this.p.subtract(o.ONE),f=this.q.subtract(o.ONE),u=a.multiply(f);if(0==u.gcd(i).compareTo(o.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(u),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(f),this.coeff=this.q.modInverse(this.p);break}}}function zr(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var r=t.mod(this.p).modPow(this.dmp1,this.p),e=t.mod(this.q).modPow(this.dmq1,this.q);r.compareTo(e)<0;)r=r.add(this.p);return r.subtract(e).multiply(this.coeff).mod(this.p).multiply(this.q).add(e)}function Vr(t){var r=Lr(t,16),e=this.doPrivate(r);return null==e?null:qr(e,this.n.bitLength()+7>>3)}Nr.prototype.doPublic=Cr,Nr.prototype.setPublic=Pr,Nr.prototype.encrypt=Mr,Nr.prototype.toJSON=_r,Nr.parse=kr,Nr.prototype.doPrivate=zr,Nr.prototype.setPrivate=Hr,Nr.prototype.setPrivateEx=Fr,Nr.prototype.generate=Zr,Nr.prototype.decrypt=Vr;var jr=[];jr.sha1="3021300906052b0e03021a05000414",jr.sha256="3031300d060960864801650304020105000420";var Kr=[];function Wr(t,r,e){for(var n=r/4,i=(0,Kr[e])(t),o="0001",s="00"+jr[e]+i,a="",f=n-o.length-s.length,u=0;u<f;u+=2)a+="ff";return o+a+s}function Gr(t,r){var e=Lr(Wr(t,this.n.bitLength(),r),16);return this.doPrivate(e).toString(16)}function $r(t){var r=Lr(Wr(t,this.n.bitLength(),"sha1"),16);return this.doPrivate(r).toString(16)}function Jr(t){var r=Lr(Wr(t,this.n.bitLength(),"sha256"),16);return this.doPrivate(r).toString(16)}function Xr(t,r,e){var n=new Nr;return n.setPublic(r,e),n.doPublic(t)}function Yr(t,r,e){return Xr(t,r,e).toString(16).replace(/^1f+00/,"")}function Qr(t){for(var r in jr){var e=jr[r],n=e.length;if(t.substring(0,n)==e)return[r,t.substring(n)]}return[]}function te(t,r,e,n){var i=Qr(Yr(r,e,n));if(0==i.length)return!1;var o=i[0];return i[1]==(0,Kr[o])(t)}function re(t,r){return te(r,Lr(t,16),this.n.toString(16),this.e.toString(16))}function ee(t,r){var e=Lr(r=r.replace(/[ \n]+/g,""),16),n=Qr(this.doPublic(e).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;var i=n[0];return n[1]==(0,Kr[i])(t)}Kr.sha1=Dr.hex,Kr.sha256=Ir.hex,Nr.prototype.signString=Gr,Nr.prototype.signStringWithSHA1=$r,Nr.prototype.signStringWithSHA256=Jr,Nr.prototype.verifyString=ee,Nr.prototype.verifyHexSignatureForMessage=re;var ne=function(){var t={};return t.Sbox=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22),t.ShiftRowTab=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11),t.Init=function(){t.Sbox_Inv=new Array(256);for(var r=0;r<256;r++)t.Sbox_Inv[t.Sbox[r]]=r;for(t.ShiftRowTab_Inv=new Array(16),r=0;r<16;r++)t.ShiftRowTab_Inv[t.ShiftRowTab[r]]=r;for(t.xtime=new Array(256),r=0;r<128;r++)t.xtime[r]=r<<1,t.xtime[128+r]=r<<1^27},t.Done=function(){delete t.Sbox_Inv,delete t.ShiftRowTab_Inv,delete t.xtime},t.ExpandKey=function(r){var e,n=r.length,i=1;switch(n){case 16:e=176;break;case 24:e=208;break;case 32:e=240;break;default:alert("my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(var o=n;o<e;o+=4){var s=r.slice(o-4,o);o%n==0?(s=new Array(t.Sbox[s[1]]^i,t.Sbox[s[2]],t.Sbox[s[3]],t.Sbox[s[0]]),(i<<=1)>=256&&(i^=283)):n>24&&o%n==16&&(s=new Array(t.Sbox[s[0]],t.Sbox[s[1]],t.Sbox[s[2]],t.Sbox[s[3]]));for(var a=0;a<4;a++)r[o+a]=r[o+a-n]^s[a]}},t.Encrypt=function(r,e){var n=e.length;t.AddRoundKey(r,e.slice(0,16));for(var i=16;i<n-16;i+=16)t.SubBytes(r,t.Sbox),t.ShiftRows(r,t.ShiftRowTab),t.MixColumns(r),t.AddRoundKey(r,e.slice(i,i+16));t.SubBytes(r,t.Sbox),t.ShiftRows(r,t.ShiftRowTab),t.AddRoundKey(r,e.slice(i,n))},t.Decrypt=function(r,e){var n=e.length;t.AddRoundKey(r,e.slice(n-16,n)),t.ShiftRows(r,t.ShiftRowTab_Inv),t.SubBytes(r,t.Sbox_Inv);for(var i=n-32;i>=16;i-=16)t.AddRoundKey(r,e.slice(i,i+16)),t.MixColumns_Inv(r),t.ShiftRows(r,t.ShiftRowTab_Inv),t.SubBytes(r,t.Sbox_Inv);t.AddRoundKey(r,e.slice(0,16))},t.SubBytes=function(t,r){for(var e=0;e<16;e++)t[e]=r[t[e]]},t.AddRoundKey=function(t,r){for(var e=0;e<16;e++)t[e]^=r[e]},t.ShiftRows=function(t,r){for(var e=(new Array).concat(t),n=0;n<16;n++)t[n]=e[r[n]]},t.MixColumns=function(r){for(var e=0;e<16;e+=4){var n=r[e+0],i=r[e+1],o=r[e+2],s=r[e+3],a=n^i^o^s;r[e+0]^=a^t.xtime[n^i],r[e+1]^=a^t.xtime[i^o],r[e+2]^=a^t.xtime[o^s],r[e+3]^=a^t.xtime[s^n]}},t.MixColumns_Inv=function(r){for(var e=0;e<16;e+=4){var n=r[e+0],i=r[e+1],o=r[e+2],s=r[e+3],a=n^i^o^s,f=t.xtime[a],u=t.xtime[t.xtime[f^n^o]]^a,h=t.xtime[t.xtime[f^i^s]]^a;r[e+0]^=u^t.xtime[n^i],r[e+1]^=h^t.xtime[i^o],r[e+2]^=u^t.xtime[o^s],r[e+3]^=h^t.xtime[s^n]}},t}(),ie=function(){var t={};ne.Init();var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t.b256to64=function(t){var e,n,i,o="",s=0,a=t.length;for(i=0;i<a;i++)n=t.charCodeAt(i),0==s?(o+=r.charAt(n>>2&63),e=(3&n)<<4):1==s?(o+=r.charAt(e|n>>4&15),e=(15&n)<<2):2==s&&(o+=r.charAt(e|n>>6&3),o+=r.charAt(63&n)),3==(s+=1)&&(s=0);return s>0&&(o+=r.charAt(e),o+="="),1==s&&(o+="="),o},t.b64to256=function(t){var e,n,i="",o=0,s=0,a=t.length;for(n=0;n<a;n++)(e=r.indexOf(t.charAt(n)))>=0&&(o&&(i+=String.fromCharCode(s|e>>6-o&255)),s=e<<(o=o+2&7)&255);return i},t.b16to64=function(t){var e,n,i="";for(t.length%2==1&&(t="0"+t),e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),i+=r.charAt(n>>6)+r.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),i+=r.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),i+=r.charAt(n>>2)+r.charAt((3&n)<<4));(3&i.length)>0;)i+="=";return i},t.b64to16=function(t){var e,n,i="",o=0;for(e=0;e<t.length&&"="!=t.charAt(e);++e)v=r.indexOf(t.charAt(e)),v<0||(0==o?(i+=p(v>>2),n=3&v,o=1):1==o?(i+=p(n<<2|v>>4),n=15&v,o=2):2==o?(i+=p(n),i+=p(v>>2),n=3&v,o=3):(i+=p(n<<2|v>>4),i+=p(15&v),o=0));return 1==o&&(i+=p(n<<2)),i},t.string2bytes=function(t){for(var r=new Array,e=0;e<t.length;e++)r.push(t.charCodeAt(e));return r},t.bytes2string=function(t){for(var r="",e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r},t.blockXOR=function(t,r){for(var e=new Array(16),n=0;n<16;n++)e[n]=t[n]^r[n];return e},t.blockIV=function(){var t=new Br,r=new Array(16);return t.nextBytes(r),r},t.pad16=function(t){var r=t.slice(0),e=(16-t.length%16)%16;for(i=t.length;i<t.length+e;i++)r.push(0);return r},t.depad=function(t){for(var r=t.slice(0);0==r[r.length-1];)r=r.slice(0,r.length-1);return r},t.encryptAESCBC=function(r,e){var n=e.slice(0);ne.ExpandKey(n);var i=t.string2bytes(r);i=t.pad16(i);for(var o=t.blockIV(),s=0;s<i.length/16;s++){var a=i.slice(16*s,16*s+16),f=o.slice(16*s,16*s+16);a=t.blockXOR(f,a),ne.Encrypt(a,n),o=o.concat(a)}var u=t.bytes2string(o);return t.b256to64(u)},t.decryptAESCBC=function(r,e){var n=e.slice(0);ne.ExpandKey(n),r=t.b64to256(r);for(var i=t.string2bytes(r),o=new Array,s=1;s<i.length/16;s++){var a=i.slice(16*s,16*s+16),f=i.slice(16*(s-1),16*(s-1)+16);ne.Decrypt(a,n),a=t.blockXOR(f,a),o=o.concat(a)}return o=t.depad(o),t.bytes2string(o)},t.wrap60=function(t){for(var r="",e=0;e<t.length;e++)e%60==0&&0!=e&&(r+="\n"),r+=t[e];return r},t.generateAESKey=function(){var t=new Array(32);return(new Br).nextBytes(t),t},t.generateRSAKey=function(t,r){Math.seedrandom(Ir.hex(t));var e=new Nr;return e.generate(r,"03"),e},t.publicKeyString=function(r){return pubkey=t.b16to64(r.n.toString(16)),pubkey},t.publicKeyID=function(t){return Ur(t)},t.publicKeyFromString=function(r){var e=t.b64to16(r.split("|")[0]),n="03",i=new Nr;return i.setPublic(e,n),i},t.encrypt=function(r,e,n){var i="",o=t.generateAESKey();try{var s=t.publicKeyFromString(e);i+=t.b16to64(s.encrypt(t.bytes2string(o)))+"?"}catch(a){return{status:"Invalid public key"}}return n&&(signString=ie.b16to64(n.signString(r,"sha256")),r+="::52cee64bb3a38f6403386519a39ac91c::",r+=ie.publicKeyString(n),r+="::52cee64bb3a38f6403386519a39ac91c::",r+=signString),{status:"success",cipher:i+=t.encryptAESCBC(r,o)}},t.decrypt=function(r,e){var n=r.split("?"),i=e.decrypt(t.b64to16(n[0]));if(null==i)return{status:"failure"};i=t.string2bytes(i);var o=t.decryptAESCBC(n[1],i).split("::52cee64bb3a38f6403386519a39ac91c::");if(3==o.length){var s=t.publicKeyFromString(o[1]),a=t.b64to16(o[2]);return s.verifyString(o[0],a)?{status:"success",plaintext:o[0],signature:"verified",publicKeyString:t.publicKeyString(s)}:{status:"success",plaintext:o[0],signature:"forged",publicKeyString:t.publicKeyString(s)}}return{status:"success",plaintext:o[0],signature:"unsigned"}},t}();r.exports=ie,r.exports.RSAKey=Nr,"undefined"!==typeof window&&(window.cryptico=r.exports)},{crypto:6}],2:[function(t,r,e){var n=t("base64-js"),i=t("ieee754");function o(t,r,e){if(!(this instanceof o))return new o(t,r,e);var n,i,s,a=typeof t;if("base64"===r&&"string"===a)for(t=U(t);t.length%4!==0;)t+="=";if("number"===a)n=N(t);else if("string"===a)n=o.byteLength(t,r);else{if("object"!==a)throw new Error("First argument needs to be a number, array or string.");n=N(t.length)}if(o._useTypedArrays?i=o._augment(new Uint8Array(n)):((i=this).length=n,i._isBuffer=!0),o._useTypedArrays&&"number"===typeof t.byteLength)i._set(t);else if(C(t))for(s=0;s<n;s++)o.isBuffer(t)?i[s]=t.readUInt8(s):i[s]=t[s];else if("string"===a)i.write(t,0,r);else if("number"===a&&!o._useTypedArrays&&!e)for(s=0;s<n;s++)i[s]=0;return i}function s(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var s=r.length;K(s%2===0,"Invalid hex string"),n>s/2&&(n=s/2);for(var a=0;a<n;a++){var f=parseInt(r.substr(2*a,2),16);K(!isNaN(f),"Invalid hex string"),t[e+a]=f}return o._charsWritten=2*a,a}function a(t,r,e,n){return o._charsWritten=F(_(r),t,e,n)}function f(t,r,e,n){return o._charsWritten=F(k(r),t,e,n)}function u(t,r,e,n){return f(t,r,e,n)}function h(t,r,e,n){return o._charsWritten=F(H(r),t,e,n)}function c(t,r,e,n){return o._charsWritten=F(q(r),t,e,n)}function l(t,r,e){return 0===r&&e===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(r,e))}function p(t,r,e){var n="",i="";e=Math.min(t.length,e);for(var o=r;o<e;o++)t[o]<=127?(n+=Z(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+Z(i)}function d(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;i++)n+=String.fromCharCode(t[i]);return n}function y(t,r,e){return d(t,r,e)}function g(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;o++)i+=M(t[o]);return i}function v(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function m(t,r,e,n){n||(K("boolean"===typeof e,"missing or invalid endian"),K(void 0!==r&&null!==r,"missing offset"),K(r+1<t.length,"Trying to read beyond buffer length"));var i,o=t.length;if(!(r>=o))return e?(i=t[r],r+1<o&&(i|=t[r+1]<<8)):(i=t[r]<<8,r+1<o&&(i|=t[r+1])),i}function w(t,r,e,n){n||(K("boolean"===typeof e,"missing or invalid endian"),K(void 0!==r&&null!==r,"missing offset"),K(r+3<t.length,"Trying to read beyond buffer length"));var i,o=t.length;if(!(r>=o))return e?(r+2<o&&(i=t[r+2]<<16),r+1<o&&(i|=t[r+1]<<8),i|=t[r],r+3<o&&(i+=t[r+3]<<24>>>0)):(r+1<o&&(i=t[r+1]<<16),r+2<o&&(i|=t[r+2]<<8),r+3<o&&(i|=t[r+3]),i+=t[r]<<24>>>0),i}function b(t,r,e,n){if(n||(K("boolean"===typeof e,"missing or invalid endian"),K(void 0!==r&&null!==r,"missing offset"),K(r+1<t.length,"Trying to read beyond buffer length")),!(r>=t.length)){var i=m(t,r,e,!0);return 32768&i?-1*(65535-i+1):i}}function E(t,r,e,n){if(n||(K("boolean"===typeof e,"missing or invalid endian"),K(void 0!==r&&null!==r,"missing offset"),K(r+3<t.length,"Trying to read beyond buffer length")),!(r>=t.length)){var i=w(t,r,e,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function S(t,r,e,n){return n||(K("boolean"===typeof e,"missing or invalid endian"),K(r+3<t.length,"Trying to read beyond buffer length")),i.read(t,r,e,23,4)}function x(t,r,e,n){return n||(K("boolean"===typeof e,"missing or invalid endian"),K(r+7<t.length,"Trying to read beyond buffer length")),i.read(t,r,e,52,8)}function B(t,r,e,n,i){i||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+1<t.length,"trying to write beyond buffer length"),z(r,65535));var o=t.length;if(!(e>=o))for(var s=0,a=Math.min(o-e,2);s<a;s++)t[e+s]=(r&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function A(t,r,e,n,i){i||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+3<t.length,"trying to write beyond buffer length"),z(r,4294967295));var o=t.length;if(!(e>=o))for(var s=0,a=Math.min(o-e,4);s<a;s++)t[e+s]=r>>>8*(n?s:3-s)&255}function T(t,r,e,n,i){i||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+1<t.length,"Trying to write beyond buffer length"),V(r,32767,-32768)),e>=t.length||B(t,r>=0?r:65535+r+1,e,n,i)}function I(t,r,e,n,i){i||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+3<t.length,"Trying to write beyond buffer length"),V(r,2147483647,-2147483648)),e>=t.length||A(t,r>=0?r:4294967295+r+1,e,n,i)}function R(t,r,e,n,o){o||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+3<t.length,"Trying to write beyond buffer length"),j(r,34028234663852886e22,-34028234663852886e22)),e>=t.length||i.write(t,r,e,n,23,4)}function D(t,r,e,n,o){o||(K(void 0!==r&&null!==r,"missing value"),K("boolean"===typeof n,"missing or invalid endian"),K(void 0!==e&&null!==e,"missing offset"),K(e+7<t.length,"Trying to write beyond buffer length"),j(r,17976931348623157e292,-17976931348623157e292)),e>=t.length||i.write(t,r,e,n,52,8)}function U(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}e.Buffer=o,e.SlowBuffer=o,e.INSPECT_MAX_BYTES=50,o.poolSize=8192,o._useTypedArrays=function(){try{var t=new ArrayBuffer(0),r=new Uint8Array(t);return r.foo=function(){return 42},42===r.foo()&&"function"===typeof r.subarray}catch(e){return!1}}(),o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},o.byteLength=function(t,r){var e;switch(t+="",r||"utf8"){case"hex":e=t.length/2;break;case"utf8":case"utf-8":e=_(t).length;break;case"ascii":case"binary":case"raw":e=t.length;break;case"base64":e=H(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":e=2*t.length;break;default:throw new Error("Unknown encoding")}return e},o.concat=function(t,r){if(K(P(t),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===t.length)return new o(0);if(1===t.length)return t[0];var e;if("number"!==typeof r)for(r=0,e=0;e<t.length;e++)r+=t[e].length;var n=new o(r),i=0;for(e=0;e<t.length;e++){var s=t[e];s.copy(n,i),i+=s.length}return n},o.prototype.write=function(t,r,e,n){if(isFinite(r))isFinite(e)||(n=e,e=void 0);else{var i=n;n=r,r=e,e=i}r=Number(r)||0;var o,l=this.length-r;switch(e?(e=Number(e))>l&&(e=l):e=l,n=String(n||"utf8").toLowerCase()){case"hex":o=s(this,t,r,e);break;case"utf8":case"utf-8":o=a(this,t,r,e);break;case"ascii":o=f(this,t,r,e);break;case"binary":o=u(this,t,r,e);break;case"base64":o=h(this,t,r,e);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=c(this,t,r,e);break;default:throw new Error("Unknown encoding")}return o},o.prototype.toString=function(t,r,e){var n,i=this;if(t=String(t||"utf8").toLowerCase(),r=Number(r)||0,(e=void 0!==e?Number(e):e=i.length)===r)return"";switch(t){case"hex":n=g(i,r,e);break;case"utf8":case"utf-8":n=p(i,r,e);break;case"ascii":n=d(i,r,e);break;case"binary":n=y(i,r,e);break;case"base64":n=l(i,r,e);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=v(i,r,e);break;default:throw new Error("Unknown encoding")}return n},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.copy=function(t,r,e,n){var i=this;if(e||(e=0),n||0===n||(n=this.length),r||(r=0),n!==e&&0!==t.length&&0!==i.length){K(n>=e,"sourceEnd < sourceStart"),K(r>=0&&r<t.length,"targetStart out of bounds"),K(e>=0&&e<i.length,"sourceStart out of bounds"),K(n>=0&&n<=i.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var s=n-e;if(s<100||!o._useTypedArrays)for(var a=0;a<s;a++)t[a+r]=this[a+e];else t._set(this.subarray(e,e+s),r)}},o.prototype.slice=function(t,r){var e=this.length;if(t=O(t,e,0),r=O(r,e,e),o._useTypedArrays)return o._augment(this.subarray(t,r));for(var n=r-t,i=new o(n,void 0,!0),s=0;s<n;s++)i[s]=this[s+t];return i},o.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},o.prototype.set=function(t,r){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,r)},o.prototype.readUInt8=function(t,r){if(r||(K(void 0!==t&&null!==t,"missing offset"),K(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length))return this[t]},o.prototype.readUInt16LE=function(t,r){return m(this,t,!0,r)},o.prototype.readUInt16BE=function(t,r){return m(this,t,!1,r)},o.prototype.readUInt32LE=function(t,r){return w(this,t,!0,r)},o.prototype.readUInt32BE=function(t,r){return w(this,t,!1,r)},o.prototype.readInt8=function(t,r){if(r||(K(void 0!==t&&null!==t,"missing offset"),K(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length))return 128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,r){return b(this,t,!0,r)},o.prototype.readInt16BE=function(t,r){return b(this,t,!1,r)},o.prototype.readInt32LE=function(t,r){return E(this,t,!0,r)},o.prototype.readInt32BE=function(t,r){return E(this,t,!1,r)},o.prototype.readFloatLE=function(t,r){return S(this,t,!0,r)},o.prototype.readFloatBE=function(t,r){return S(this,t,!1,r)},o.prototype.readDoubleLE=function(t,r){return x(this,t,!0,r)},o.prototype.readDoubleBE=function(t,r){return x(this,t,!1,r)},o.prototype.writeUInt8=function(t,r,e){e||(K(void 0!==t&&null!==t,"missing value"),K(void 0!==r&&null!==r,"missing offset"),K(r<this.length,"trying to write beyond buffer length"),z(t,255)),r>=this.length||(this[r]=t)},o.prototype.writeUInt16LE=function(t,r,e){B(this,t,r,!0,e)},o.prototype.writeUInt16BE=function(t,r,e){B(this,t,r,!1,e)},o.prototype.writeUInt32LE=function(t,r,e){A(this,t,r,!0,e)},o.prototype.writeUInt32BE=function(t,r,e){A(this,t,r,!1,e)},o.prototype.writeInt8=function(t,r,e){e||(K(void 0!==t&&null!==t,"missing value"),K(void 0!==r&&null!==r,"missing offset"),K(r<this.length,"Trying to write beyond buffer length"),V(t,127,-128)),r>=this.length||(t>=0?this.writeUInt8(t,r,e):this.writeUInt8(255+t+1,r,e))},o.prototype.writeInt16LE=function(t,r,e){T(this,t,r,!0,e)},o.prototype.writeInt16BE=function(t,r,e){T(this,t,r,!1,e)},o.prototype.writeInt32LE=function(t,r,e){I(this,t,r,!0,e)},o.prototype.writeInt32BE=function(t,r,e){I(this,t,r,!1,e)},o.prototype.writeFloatLE=function(t,r,e){R(this,t,r,!0,e)},o.prototype.writeFloatBE=function(t,r,e){R(this,t,r,!1,e)},o.prototype.writeDoubleLE=function(t,r,e){D(this,t,r,!0,e)},o.prototype.writeDoubleBE=function(t,r,e){D(this,t,r,!1,e)},o.prototype.fill=function(t,r,e){if(t||(t=0),r||(r=0),e||(e=this.length),"string"===typeof t&&(t=t.charCodeAt(0)),K("number"===typeof t&&!isNaN(t),"value is not a number"),K(e>=r,"end < start"),e!==r&&0!==this.length){K(r>=0&&r<this.length,"start out of bounds"),K(e>=0&&e<=this.length,"end out of bounds");for(var n=r;n<e;n++)this[n]=t}},o.prototype.inspect=function(){for(var t=[],r=this.length,n=0;n<r;n++)if(t[n]=M(this[n]),n===e.INSPECT_MAX_BYTES){t[n+1]="...";break}return"<Buffer "+t.join(" ")+">"},o.prototype.toArrayBuffer=function(){if("undefined"!==typeof Uint8Array){if(o._useTypedArrays)return new o(this).buffer;for(var t=new Uint8Array(this.length),r=0,e=t.length;r<e;r+=1)t[r]=this[r];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var L=o.prototype;function O(t,r,e){return"number"!==typeof t?e:(t=~~t)>=r?r:t>=0||(t+=r)>=0?t:0}function N(t){return(t=~~Math.ceil(+t))<0?0:t}function P(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function C(t){return P(t)||o.isBuffer(t)||t&&"object"===typeof t&&"number"===typeof t.length}function M(t){return t<16?"0"+t.toString(16):t.toString(16)}function _(t){for(var r=[],e=0;e<t.length;e++){var n=t.charCodeAt(e);if(n<=127)r.push(t.charCodeAt(e));else{var i=e;n>=55296&&n<=57343&&e++;for(var o=encodeURIComponent(t.slice(i,e+1)).substr(1).split("%"),s=0;s<o.length;s++)r.push(parseInt(o[s],16))}}return r}function k(t){for(var r=[],e=0;e<t.length;e++)r.push(255&t.charCodeAt(e));return r}function q(t){for(var r,e,n,i=[],o=0;o<t.length;o++)e=(r=t.charCodeAt(o))>>8,n=r%256,i.push(n),i.push(e);return i}function H(t){return n.toByteArray(t)}function F(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);i++)r[i+e]=t[i];return i}function Z(t){try{return decodeURIComponent(t)}catch(r){return String.fromCharCode(65533)}}function z(t,r){K("number"===typeof t,"cannot write a non-number as a number"),K(t>=0,"specified a negative value for writing an unsigned value"),K(t<=r,"value is larger than maximum value for type"),K(Math.floor(t)===t,"value has a fractional component")}function V(t,r,e){K("number"===typeof t,"cannot write a non-number as a number"),K(t<=r,"value larger than maximum allowed value"),K(t>=e,"value smaller than minimum allowed value"),K(Math.floor(t)===t,"value has a fractional component")}function j(t,r,e){K("number"===typeof t,"cannot write a non-number as a number"),K(t<=r,"value larger than maximum allowed value"),K(t>=e,"value smaller than minimum allowed value")}function K(t,r){if(!t)throw new Error(r||"Failed assertion")}o._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=L.get,t.set=L.set,t.write=L.write,t.toString=L.toString,t.toLocaleString=L.toString,t.toJSON=L.toJSON,t.copy=L.copy,t.slice=L.slice,t.readUInt8=L.readUInt8,t.readUInt16LE=L.readUInt16LE,t.readUInt16BE=L.readUInt16BE,t.readUInt32LE=L.readUInt32LE,t.readUInt32BE=L.readUInt32BE,t.readInt8=L.readInt8,t.readInt16LE=L.readInt16LE,t.readInt16BE=L.readInt16BE,t.readInt32LE=L.readInt32LE,t.readInt32BE=L.readInt32BE,t.readFloatLE=L.readFloatLE,t.readFloatBE=L.readFloatBE,t.readDoubleLE=L.readDoubleLE,t.readDoubleBE=L.readDoubleBE,t.writeUInt8=L.writeUInt8,t.writeUInt16LE=L.writeUInt16LE,t.writeUInt16BE=L.writeUInt16BE,t.writeUInt32LE=L.writeUInt32LE,t.writeUInt32BE=L.writeUInt32BE,t.writeInt8=L.writeInt8,t.writeInt16LE=L.writeInt16LE,t.writeInt16BE=L.writeInt16BE,t.writeInt32LE=L.writeInt32LE,t.writeInt32BE=L.writeInt32BE,t.writeFloatLE=L.writeFloatLE,t.writeFloatBE=L.writeFloatBE,t.writeDoubleLE=L.writeDoubleLE,t.writeDoubleBE=L.writeDoubleBE,t.fill=L.fill,t.inspect=L.inspect,t.toArrayBuffer=L.toArrayBuffer,t}},{"base64-js":3,ieee754:4}],3:[function(t,r,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";var r="undefined"!==typeof Uint8Array?Uint8Array:Array,e="+".charCodeAt(0),i="/".charCodeAt(0),o="0".charCodeAt(0),s="a".charCodeAt(0),a="A".charCodeAt(0),f="-".charCodeAt(0),u="_".charCodeAt(0);function h(t){var r=t.charCodeAt(0);return r===e||r===f?62:r===i||r===u?63:r<o?-1:r<o+10?r-o+26+26:r<a+26?r-a:r<s+26?r-s+26:void 0}function c(t){var e,n,i,o,s,a;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=t.length;s="="===t.charAt(f-2)?2:"="===t.charAt(f-1)?1:0,a=new r(3*t.length/4-s),i=s>0?t.length-4:t.length;var u=0;function c(t){a[u++]=t}for(e=0,n=0;e<i;e+=4,n+=3)c((16711680&(o=h(t.charAt(e))<<18|h(t.charAt(e+1))<<12|h(t.charAt(e+2))<<6|h(t.charAt(e+3))))>>16),c((65280&o)>>8),c(255&o);return 2===s?c(255&(o=h(t.charAt(e))<<2|h(t.charAt(e+1))>>4)):1===s&&(c((o=h(t.charAt(e))<<10|h(t.charAt(e+1))<<4|h(t.charAt(e+2))>>2)>>8&255),c(255&o)),a}function l(t){var r,e,i,o=t.length%3,s="";function a(t){return n.charAt(t)}function f(t){return a(t>>18&63)+a(t>>12&63)+a(t>>6&63)+a(63&t)}for(r=0,i=t.length-o;r<i;r+=3)s+=f(e=(t[r]<<16)+(t[r+1]<<8)+t[r+2]);switch(o){case 1:s+=a((e=t[t.length-1])>>2),s+=a(e<<4&63),s+="==";break;case 2:s+=a((e=(t[t.length-2]<<8)+t[t.length-1])>>10),s+=a(e>>4&63),s+=a(e<<2&63),s+="="}return s}t.toByteArray=c,t.fromByteArray=l}("undefined"===typeof e?this.base64js={}:e)},{}],4:[function(t,r,e){e.read=function(t,r,e,n,i){var o,s,a=8*i-n-1,f=(1<<a)-1,u=f>>1,h=-7,c=e?i-1:0,l=e?-1:1,p=t[r+c];for(c+=l,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[r+c],c+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[r+c],c+=l,h-=8);if(0===o)o=1-u;else{if(o===f)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,r,e,n,i,o){var s,a,f,u=8*o-i-1,h=(1<<u)-1,c=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(a=isNaN(r)?1:0,s=h):(s=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-s))<1&&(s--,f*=2),(r+=s+c>=1?l/f:l*Math.pow(2,1-c))*f>=2&&(s++,f/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(r*f-1)*Math.pow(2,i),s+=c):(a=r*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[e+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[e+p]=255&s,p+=d,s/=256,u-=8);t[e+p-d]|=128*y}},{}],5:[function(t,r,e){var n=t("buffer").Buffer,i=4,o=new n(i);o.fill(0);var s=8;function a(t,r){if(t.length%i!==0){var e=t.length+(i-t.length%i);t=n.concat([t,o],e)}for(var s=[],a=r?t.readInt32BE:t.readInt32LE,f=0;f<t.length;f+=i)s.push(a.call(t,f));return s}function f(t,r,e){for(var i=new n(r),o=e?i.writeInt32BE:i.writeInt32LE,s=0;s<t.length;s++)o.call(i,t[s],4*s,!0);return i}function u(t,r,e,i){return n.isBuffer(t)||(t=new n(t)),f(r(a(t,i),t.length*s),e,i)}r.exports={hash:u}},{buffer:2}],6:[function(t,r,e){var n=t("buffer").Buffer,i=t("./sha"),o=t("./sha256"),s=t("./rng"),a={sha1:i,sha256:o,md5:t("./md5")},f=64,u=new n(f);function h(t,r,e){n.isBuffer(r)||(r=new n(r)),n.isBuffer(e)||(e=new n(e)),r.length>f?r=t(r):r.length<f&&(r=n.concat([r,u],f));for(var i=new n(f),o=new n(f),s=0;s<f;s++)i[s]=54^r[s],o[s]=92^r[s];var a=t(n.concat([i,e]));return t(n.concat([o,a]))}function c(t,r){var e=a[t=t||"sha1"],i=[];return e||l("algorithm:",t,"is not yet supported"),{update:function(t){return n.isBuffer(t)||(t=new n(t)),i.push(t),t.length,this},digest:function(t){var o=n.concat(i),s=r?h(e,r,o):e(o);return i=null,t?s.toString(t):s}}}function l(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function p(t,r){for(var e in t)r(t[e],e)}u.fill(0),e.createHash=function(t){return c(t)},e.createHmac=function(t,r){return c(t,r)},e.randomBytes=function(t,r){if(!r||!r.call)return new n(s(t));try{r.call(this,void 0,new n(s(t)))}catch(e){r(e)}},p(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(t){e[t]=function(){l("sorry,",t,"is not implemented yet")}}))},{"./md5":7,"./rng":8,"./sha":9,"./sha256":10,buffer:2}],7:[function(t,r,e){var n=t("./helpers");function i(t,r){t[r>>5]|=128<<r%32,t[14+(r+64>>>9<<4)]=r;for(var e=1732584193,n=-271733879,i=-1732584194,o=271733878,c=0;c<t.length;c+=16){var l=e,p=n,d=i,y=o;e=s(e,n,i,o,t[c+0],7,-680876936),o=s(o,e,n,i,t[c+1],12,-389564586),i=s(i,o,e,n,t[c+2],17,606105819),n=s(n,i,o,e,t[c+3],22,-1044525330),e=s(e,n,i,o,t[c+4],7,-176418897),o=s(o,e,n,i,t[c+5],12,1200080426),i=s(i,o,e,n,t[c+6],17,-1473231341),n=s(n,i,o,e,t[c+7],22,-45705983),e=s(e,n,i,o,t[c+8],7,1770035416),o=s(o,e,n,i,t[c+9],12,-1958414417),i=s(i,o,e,n,t[c+10],17,-42063),n=s(n,i,o,e,t[c+11],22,-1990404162),e=s(e,n,i,o,t[c+12],7,1804603682),o=s(o,e,n,i,t[c+13],12,-40341101),i=s(i,o,e,n,t[c+14],17,-1502002290),e=a(e,n=s(n,i,o,e,t[c+15],22,1236535329),i,o,t[c+1],5,-165796510),o=a(o,e,n,i,t[c+6],9,-1069501632),i=a(i,o,e,n,t[c+11],14,643717713),n=a(n,i,o,e,t[c+0],20,-373897302),e=a(e,n,i,o,t[c+5],5,-701558691),o=a(o,e,n,i,t[c+10],9,38016083),i=a(i,o,e,n,t[c+15],14,-660478335),n=a(n,i,o,e,t[c+4],20,-405537848),e=a(e,n,i,o,t[c+9],5,568446438),o=a(o,e,n,i,t[c+14],9,-1019803690),i=a(i,o,e,n,t[c+3],14,-187363961),n=a(n,i,o,e,t[c+8],20,1163531501),e=a(e,n,i,o,t[c+13],5,-1444681467),o=a(o,e,n,i,t[c+2],9,-51403784),i=a(i,o,e,n,t[c+7],14,1735328473),e=f(e,n=a(n,i,o,e,t[c+12],20,-1926607734),i,o,t[c+5],4,-378558),o=f(o,e,n,i,t[c+8],11,-2022574463),i=f(i,o,e,n,t[c+11],16,1839030562),n=f(n,i,o,e,t[c+14],23,-35309556),e=f(e,n,i,o,t[c+1],4,-1530992060),o=f(o,e,n,i,t[c+4],11,1272893353),i=f(i,o,e,n,t[c+7],16,-155497632),n=f(n,i,o,e,t[c+10],23,-1094730640),e=f(e,n,i,o,t[c+13],4,681279174),o=f(o,e,n,i,t[c+0],11,-358537222),i=f(i,o,e,n,t[c+3],16,-722521979),n=f(n,i,o,e,t[c+6],23,76029189),e=f(e,n,i,o,t[c+9],4,-640364487),o=f(o,e,n,i,t[c+12],11,-421815835),i=f(i,o,e,n,t[c+15],16,530742520),e=u(e,n=f(n,i,o,e,t[c+2],23,-995338651),i,o,t[c+0],6,-198630844),o=u(o,e,n,i,t[c+7],10,1126891415),i=u(i,o,e,n,t[c+14],15,-1416354905),n=u(n,i,o,e,t[c+5],21,-57434055),e=u(e,n,i,o,t[c+12],6,1700485571),o=u(o,e,n,i,t[c+3],10,-1894986606),i=u(i,o,e,n,t[c+10],15,-1051523),n=u(n,i,o,e,t[c+1],21,-2054922799),e=u(e,n,i,o,t[c+8],6,1873313359),o=u(o,e,n,i,t[c+15],10,-30611744),i=u(i,o,e,n,t[c+6],15,-1560198380),n=u(n,i,o,e,t[c+13],21,1309151649),e=u(e,n,i,o,t[c+4],6,-145523070),o=u(o,e,n,i,t[c+11],10,-1120210379),i=u(i,o,e,n,t[c+2],15,718787259),n=u(n,i,o,e,t[c+9],21,-343485551),e=h(e,l),n=h(n,p),i=h(i,d),o=h(o,y)}return Array(e,n,i,o)}function o(t,r,e,n,i,o){return h(c(h(h(r,t),h(n,o)),i),e)}function s(t,r,e,n,i,s,a){return o(r&e|~r&n,t,r,i,s,a)}function a(t,r,e,n,i,s,a){return o(r&n|e&~n,t,r,i,s,a)}function f(t,r,e,n,i,s,a){return o(r^e^n,t,r,i,s,a)}function u(t,r,e,n,i,s,a){return o(e^(r|~n),t,r,i,s,a)}function h(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}function c(t,r){return t<<r|t>>>32-r}r.exports=function(t){return n.hash(t,i,16)}},{"./helpers":5}],8:[function(t,r,e){!function(){var t,e;t=function(t){for(var r,e=new Array(t),n=0;n<t;n++)0==(3&n)&&(r=4294967296*Math.random()),e[n]=r>>>((3&n)<<3)&255;return e},this.crypto&&crypto.getRandomValues&&(e=function(t){var r=new Uint8Array(t);return crypto.getRandomValues(r),r}),r.exports=e||t}()},{}],9:[function(t,r,e){var n=t("./helpers");function i(t,r){t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r;for(var e=Array(80),n=1732584193,i=-271733879,u=-1732584194,h=271733878,c=-1009589776,l=0;l<t.length;l+=16){for(var p=n,d=i,y=u,g=h,v=c,m=0;m<80;m++){e[m]=m<16?t[l+m]:f(e[m-3]^e[m-8]^e[m-14]^e[m-16],1);var w=a(a(f(n,5),o(m,i,u,h)),a(a(c,e[m]),s(m)));c=h,h=u,u=f(i,30),i=n,n=w}n=a(n,p),i=a(i,d),u=a(u,y),h=a(h,g),c=a(c,v)}return Array(n,i,u,h,c)}function o(t,r,e,n){return t<20?r&e|~r&n:t<40?r^e^n:t<60?r&e|r&n|e&n:r^e^n}function s(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function a(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}function f(t,r){return t<<r|t>>>32-r}r.exports=function(t){return n.hash(t,i,20,!0)}},{"./helpers":5}],10:[function(t,r,e){var n=t("./helpers"),i=function(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e},o=function(t,r){return t>>>r|t<<32-r},s=function(t,r){return t>>>r},a=function(t,r,e){return t&r^~t&e},f=function(t,r,e){return t&r^t&e^r&e},u=function(t){return o(t,2)^o(t,13)^o(t,22)},h=function(t){return o(t,6)^o(t,11)^o(t,25)},c=function(t){return o(t,7)^o(t,18)^s(t,3)},l=function(t){return o(t,17)^o(t,19)^s(t,10)},p=function(t,r){var e,n,o,s,p,d,y,g,v,m,w=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),b=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),E=new Array(64);t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r;for(var S=0;S<t.length;S+=16){e=b[0],n=b[1],o=b[2],s=b[3],p=b[4],d=b[5],y=b[6],g=b[7];for(var x=0;x<64;x++)E[x]=x<16?t[x+S]:i(i(i(l(E[x-2]),E[x-7]),c(E[x-15])),E[x-16]),v=i(i(i(i(g,h(p)),a(p,d,y)),w[x]),E[x]),m=i(u(e),f(e,n,o)),g=y,y=d,d=p,p=i(s,v),s=o,o=n,n=e,e=i(v,m);b[0]=i(e,b[0]),b[1]=i(n,b[1]),b[2]=i(o,b[2]),b[3]=i(s,b[3]),b[4]=i(p,b[4]),b[5]=i(d,b[5]),b[6]=i(y,b[6]),b[7]=i(g,b[7])}return b};r.exports=function(t){return n.hash(t,p,32,!0)}},{"./helpers":5}]},{},[1])(1)},87794:function(t,r,e){t.exports=e(34051)},34051:function(t){var r=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function f(t,r,e,n){var i=r&&r.prototype instanceof y?r:y,o=Object.create(i.prototype),s=new I(n||[]);return o._invoke=function(t,r,e){var n=h;return function(i,o){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw o;return D()}for(e.method=i,e.arg=o;;){var s=e.delegate;if(s){var a=B(s,e);if(a){if(a===d)continue;return a}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===h)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var f=u(t,r,e);if("normal"===f.type){if(n=e.done?p:c,f.arg===d)continue;return{value:f.arg,done:e.done}}"throw"===f.type&&(n=p,e.method="throw",e.arg=f.arg)}}}(t,e,s),o}function u(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=f;var h="suspendedStart",c="suspendedYield",l="executing",p="completed",d={};function y(){}function g(){}function v(){}var m={};m[o]=function(){return this};var w=Object.getPrototypeOf,b=w&&w(w(R([])));b&&b!==e&&n.call(b,o)&&(m=b);var E=v.prototype=y.prototype=Object.create(m);function S(t){["next","throw","return"].forEach((function(r){t[r]=function(t){return this._invoke(r,t)}}))}function x(t,r){function e(i,o,s,a){var f=u(t[i],t,o);if("throw"!==f.type){var h=f.arg,c=h.value;return c&&"object"===typeof c&&n.call(c,"__await")?r.resolve(c.__await).then((function(t){e("next",t,s,a)}),(function(t){e("throw",t,s,a)})):r.resolve(c).then((function(t){h.value=t,s(h)}),(function(t){return e("throw",t,s,a)}))}a(f.arg)}var i;this._invoke=function(t,n){function o(){return new r((function(r,i){e(t,n,r,i)}))}return i=i?i.then(o,o):o()}}function B(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,B(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function A(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function T(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[o];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=r,e.done=!0,e};return s.next=s}}return{next:D}}function D(){return{value:r,done:!0}}return g.prototype=E.constructor=v,v.constructor=g,v[a]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"===typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},S(x.prototype),x.prototype[s]=function(){return this},t.AsyncIterator=x,t.async=function(r,e,n,i,o){void 0===o&&(o=Promise);var s=new x(f(r,e,n,i),o);return t.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),E[a]="Generator",E[o]=function(){return this},E.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var f=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(f&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(f){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=r,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),T(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var i=n.arg;T(e)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:R(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),d}},t}(t.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},27760:function(t,r,e){"use strict";var n,i=e(95856);const o=BigInt(0),s=BigInt(1),a=BigInt(2),f=BigInt(3),u=BigInt(8),h=Object.freeze({a:o,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:s,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),c=(t,r)=>(t+r/a)/r,l={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){const{n:r}=h,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-s*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,a=BigInt("0x100000000000000000000000000000000"),f=c(o*t,r),u=c(-n*t,r);let l=k(t-f*e-u*i,r),p=k(-f*n-u*o,r);const d=l>a,y=p>a;if(d&&(l=r-l),y&&(p=r-p),l>a||p>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:y,k2:p}}},p=32,d=32;function y(t){const{a:r,b:e}=h,n=k(t*t),i=k(n*t);return k(i+r*t+e)}const g=h.a===o;class v extends Error{constructor(t){super(t)}}function m(t){if(!(t instanceof w))throw new TypeError("JacobianPoint expected")}class w{constructor(t,r,e){this.x=t,this.y=r,this.z=e}static fromAffine(t){if(!(t instanceof S))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(S.ZERO)?w.ZERO:new w(t.x,t.y,s)}static toAffineBatch(t){const r=function(t,r=h.P){const e=new Array(t.length),n=H(t.reduce(((t,n,i)=>n===o?t:(e[i]=t,k(t*n,r))),s),r);return t.reduceRight(((t,n,i)=>n===o?t:(e[i]=k(t*e[i],r),k(t*n,r))),n),e}(t.map((t=>t.z)));return t.map(((t,e)=>t.toAffine(r[e])))}static normalizeZ(t){return w.toAffineBatch(t).map(w.fromAffine)}equals(t){m(t);const{x:r,y:e,z:n}=this,{x:i,y:o,z:s}=t,a=k(n*n),f=k(s*s),u=k(r*f),h=k(i*a),c=k(k(e*s)*f),l=k(k(o*n)*a);return u===h&&c===l}negate(){return new w(this.x,k(-this.y),this.z)}double(){const{x:t,y:r,z:e}=this,n=k(t*t),i=k(r*r),o=k(i*i),s=t+i,h=k(a*(k(s*s)-n-o)),c=k(f*n),l=k(c*c),p=k(l-a*h),d=k(c*(h-p)-u*o),y=k(a*r*e);return new w(p,d,y)}add(t){m(t);const{x:r,y:e,z:n}=this,{x:i,y:s,z:f}=t;if(i===o||s===o)return this;if(r===o||e===o)return t;const u=k(n*n),h=k(f*f),c=k(r*h),l=k(i*u),p=k(k(e*f)*h),d=k(k(s*n)*u),y=k(l-c),g=k(d-p);if(y===o)return g===o?this.double():w.ZERO;const v=k(y*y),b=k(y*v),E=k(c*v),S=k(g*g-b-a*E),x=k(g*(E-S)-p*b),B=k(n*f*y);return new w(S,x,B)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const r=w.ZERO;if("bigint"===typeof t&&t===o)return r;let e=_(t);if(e===s)return this;if(!g){let t=r,n=this;for(;e>o;)e&s&&(t=t.add(n)),n=n.double(),e>>=s;return t}let{k1neg:n,k1:i,k2neg:a,k2:f}=l.splitScalar(e),u=r,h=r,c=this;for(;i>o||f>o;)i&s&&(u=u.add(c)),f&s&&(h=h.add(c)),c=c.double(),i>>=s,f>>=s;return n&&(u=u.negate()),a&&(h=h.negate()),h=new w(k(h.x*l.beta),h.y,h.z),u.add(h)}precomputeWindow(t){const r=g?128/t+1:256/t+1,e=[];let n=this,i=n;for(let o=0;o<r;o++){i=n,e.push(i);for(let r=1;r<2**(t-1);r++)i=i.add(n),e.push(i);n=i.double()}return e}wNAF(t,r){!r&&this.equals(w.BASE)&&(r=S.BASE);const e=r&&r._WINDOW_SIZE||1;if(256%e)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&E.get(r);n||(n=this.precomputeWindow(e),r&&1!==e&&(n=w.normalizeZ(n),E.set(r,n)));let i=w.ZERO,o=w.BASE;const a=1+(g?128/e:256/e),f=2**(e-1),u=BigInt(2**e-1),h=2**e,c=BigInt(e);for(let l=0;l<a;l++){const r=l*f;let e=Number(t&u);t>>=c,e>f&&(e-=h,t+=s);const a=r,p=r+Math.abs(e)-1,d=l%2!==0,y=e<0;0===e?o=o.add(b(d,n[a])):i=i.add(b(y,n[p]))}return{p:i,f:o}}multiply(t,r){let e,n,i=_(t);if(g){const{k1neg:t,k1:o,k2neg:s,k2:a}=l.splitScalar(i);let{p:f,f:u}=this.wNAF(o,r),{p:h,f:c}=this.wNAF(a,r);f=b(t,f),h=b(s,h),h=new w(k(h.x*l.beta),h.y,h.z),e=f.add(h),n=u.add(c)}else{const{p:t,f:o}=this.wNAF(i,r);e=t,n=o}return w.normalizeZ([e,n])[0]}toAffine(t){const{x:r,y:e,z:n}=this,i=this.equals(w.ZERO);null==t&&(t=i?u:H(n));const o=t,a=k(o*o),f=k(a*o),h=k(r*a),c=k(e*f),l=k(n*o);if(i)return S.ZERO;if(l!==s)throw new Error("invZ was invalid");return new S(h,c)}}function b(t,r){const e=r.negate();return t?e:r}w.BASE=new w(h.Gx,h.Gy,s),w.ZERO=new w(o,s,o);const E=new WeakMap;class S{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,E.delete(this)}hasEvenY(){return this.y%a===o}static fromCompressedHex(t){const r=32===t.length,e=C(r?t:t.subarray(1));if(!j(e))throw new Error("Point is not on curve");let n=function(t){const{P:r}=h,e=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),u=BigInt(88),c=t*t*t%r,l=c*c*t%r,p=q(l,f)*l%r,d=q(p,f)*l%r,y=q(d,a)*c%r,g=q(y,n)*y%r,v=q(g,i)*g%r,m=q(v,s)*v%r,w=q(m,u)*m%r,b=q(w,s)*v%r,E=q(b,f)*l%r,S=q(E,o)*g%r,x=q(S,e)*c%r,B=q(x,a);if(B*B%r!==t)throw new Error("Cannot find square root");return B}(y(e));const i=(n&s)===s;if(r)i&&(n=k(-n));else{1===(1&t[0])!==i&&(n=k(-n))}const o=new S(e,n);return o.assertValidity(),o}static fromUncompressedHex(t){const r=C(t.subarray(1,33)),e=C(t.subarray(33,65)),n=new S(r,e);return n.assertValidity(),n}static fromHex(t){const r=M(t),e=r.length,n=r[0];if(e===p)return this.fromCompressedHex(r);if(33===e&&(2===n||3===n))return this.fromCompressedHex(r);if(65===e&&4===n)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${e}`)}static fromPrivateKey(t){return S.BASE.multiply(K(t))}static fromSignature(t,r,e){const{r:n,s:i}=W(r);if(![0,1,2,3].includes(e))throw new Error("Cannot recover: invalid recovery bit");const o=F(M(t)),{n:s}=h,a=2===e||3===e?n+s:n,f=H(a,s),u=k(-o*f,s),c=k(i*f,s),l=1&e?"03":"02",p=S.fromHex(l+U(a)),d=S.BASE.multiplyAndAddUnsafe(p,u,c);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(t=!1){return P(this.toHex(t))}toHex(t=!1){const r=U(this.x);if(t){return`${this.hasEvenY()?"02":"03"}${r}`}return`04${r}${U(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:r,y:e}=this;if(!j(r)||!j(e))throw new Error(t);const n=k(e*e);if(k(n-y(r))!==o)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new S(this.x,k(-this.y))}double(){return w.fromAffine(this).double().toAffine()}add(t){return w.fromAffine(this).add(w.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return w.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,e){const n=w.fromAffine(this),i=r===o||r===s||this!==S.BASE?n.multiplyUnsafe(r):n.multiply(r),a=w.fromAffine(t).multiplyUnsafe(e),f=i.add(a);return f.equals(w.ZERO)?void 0:f.toAffine()}}function x(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function B(t){if(t.length<2||2!==t[0])throw new Error(`Invalid signature integer tag: ${R(t)}`);const r=t[1],e=t.subarray(2,r+2);if(!r||e.length!==r)throw new Error("Invalid signature integer: wrong length");if(0===e[0]&&e[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:C(e),left:t.subarray(r+2)}}S.BASE=new S(h.Gx,h.Gy),S.ZERO=new S(o,o);class A{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){const r=t instanceof Uint8Array,e="Signature.fromCompact";if("string"!==typeof t&&!r)throw new TypeError(`${e}: Expected string or Uint8Array`);const n=r?R(t):t;if(128!==n.length)throw new Error(`${e}: Expected 64-byte hex`);return new A(N(n.slice(0,64)),N(n.slice(64,128)))}static fromDER(t){const r=t instanceof Uint8Array;if("string"!==typeof t&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:e,s:n}=function(t){if(t.length<2||48!=t[0])throw new Error(`Invalid signature tag: ${R(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");const{data:r,left:e}=B(t.subarray(2)),{data:n,left:i}=B(e);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${R(i)}`);return{r:r,s:n}}(r?t:P(t));return new A(e,n)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:r}=this;if(!V(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!V(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=h.n>>s;return this.s>t}normalizeS(){return this.hasHighS()?new A(this.r,k(-this.s,h.n)):this}toDERRawBytes(){return P(this.toDERHex())}toDERHex(){const t=x(O(this.s)),r=x(O(this.r)),e=t.length/2,n=r.length/2,i=O(e),o=O(n);return`30${O(n+e+4)}02${o}${r}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return P(this.toCompactHex())}toCompactHex(){return U(this.r)+U(this.s)}}function T(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const r=t.reduce(((t,r)=>t+r.length),0),e=new Uint8Array(r);for(let n=0,i=0;n<t.length;n++){const r=t[n];e.set(r,i),i+=r.length}return e}const I=Array.from({length:256},((t,r)=>r.toString(16).padStart(2,"0")));function R(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let r="";for(let e=0;e<t.length;e++)r+=I[t[e]];return r}const D=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function U(t){if("bigint"!==typeof t)throw new Error("Expected bigint");if(!(o<=t&&t<D))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function L(t){const r=P(U(t));if(32!==r.length)throw new Error("Error: expected 32 bytes");return r}function O(t){const r=t.toString(16);return 1&r.length?`0${r}`:r}function N(t){if("string"!==typeof t)throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function P(t){if("string"!==typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);const r=new Uint8Array(t.length/2);for(let e=0;e<r.length;e++){const n=2*e,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[e]=o}return r}function C(t){return N(R(t))}function M(t){return t instanceof Uint8Array?Uint8Array.from(t):P(t)}function _(t){if("number"===typeof t&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if("bigint"===typeof t&&V(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function k(t,r=h.P){const e=t%r;return e>=o?e:r+e}function q(t,r){const{P:e}=h;let n=t;for(;r-- >o;)n*=n,n%=e;return n}function H(t,r=h.P){if(t===o||r<=o)throw new Error(`invert: expected positive integers, got n=${t} mod=${r}`);let e=k(t,r),n=r,i=o,a=s,f=s,u=o;for(;e!==o;){const t=n/e,r=n%e,o=i-f*t,s=a-u*t;n=e,e=r,i=f,a=u,f=o,u=s}if(n!==s)throw new Error("invert: does not exist");return k(i,r)}function F(t,r=!1){const e=function(t){const r=8*t.length-256,e=C(t);return r>0?e>>BigInt(r):e}(t);if(r)return e;const{n:n}=h;return e>=n?e-n:e}let Z,z;function V(t){return o<t&&t<h.n}function j(t){return o<t&&t<h.P}function K(t){let r;if("bigint"===typeof t)r=t;else if("number"===typeof t&&Number.isSafeInteger(t)&&t>0)r=BigInt(t);else if("string"===typeof t){if(64!==t.length)throw new Error("Expected 32 bytes of private key");r=N(t)}else{if(!(t instanceof Uint8Array))throw new TypeError("Expected valid private key");if(t.length!==d)throw new Error("Expected 32 bytes of private key");r=C(t)}if(!V(r))throw new Error("Expected private key: 0 < key < n");return r}function W(t){if(t instanceof A)return t.assertValidity(),t;try{return A.fromDER(t)}catch(r){return A.fromCompact(t)}}S.BASE._setWindowSize(8);const G={node:n||(n=e.t(i,2)),web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},$={},J={bytesToHex:R,hexToBytes:P,concatBytes:T,mod:k,invert:H,isValidPrivateKey(t){try{return K(t),!0}catch(r){return!1}},_bigintTo32Bytes:L,_normalizePrivateKey:K,hashToPrivateKey:t=>{if((t=M(t)).length<40||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return L(k(C(t),h.n-s)+s)},randomBytes:(t=32)=>{if(G.web)return G.web.getRandomValues(new Uint8Array(t));if(G.node){const{randomBytes:r}=G.node;return Uint8Array.from(r(t))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>J.hashToPrivateKey(J.randomBytes(40)),precompute(t=8,r=S.BASE){const e=r===S.BASE?r:new S(r.x,r.y);return e._setWindowSize(t),e.multiply(f),e},sha256:async(...t)=>{if(G.web){const r=await G.web.subtle.digest("SHA-256",T(...t));return new Uint8Array(r)}if(G.node){const{createHash:r}=G.node,e=r("sha256");return t.forEach((t=>e.update(t))),Uint8Array.from(e.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...r)=>{if(G.web){const e=await G.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=T(...r),i=await G.web.subtle.sign("HMAC",e,n);return new Uint8Array(i)}if(G.node){const{createHmac:e}=G.node,n=e("sha256",t);return r.forEach((t=>n.update(t))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...r)=>{let e=$[t];if(void 0===e){const r=await J.sha256(Uint8Array.from(t,(t=>t.charCodeAt(0))));e=T(r,r),$[t]=e}return J.sha256(e,...r)},taggedHashSync:(t,...r)=>{if("function"!==typeof Z)throw new v("sha256Sync is undefined, you need to set it");let e=$[t];if(void 0===e){const r=Z(Uint8Array.from(t,(t=>t.charCodeAt(0))));e=T(r,r),$[t]=e}return Z(e,...r)},_JacobianPoint:w};Object.defineProperties(J,{sha256Sync:{configurable:!1,get:()=>Z,set(t){Z||(Z=t)}},hmacSha256Sync:{configurable:!1,get:()=>z,set(t){z||(z=t)}}})},35689:function(t,r,e){"use strict";var n,i=e(33397);const o=BigInt(0),s=BigInt(1),a=BigInt(2),f=BigInt(8),u=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:u,n:u,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),c=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),l=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),p=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),d=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),y=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),g=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class v{constructor(t,r,e,n){this.x=t,this.y=r,this.z=e,this.t=n}static fromAffine(t){if(!(t instanceof B))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(B.ZERO)?v.ZERO:new v(t.x,t.y,s,C(t.x*t.y))}static toAffineBatch(t){const r=function(t,r=h.P){const e=new Array(t.length),n=M(t.reduce(((t,n,i)=>n===o?t:(e[i]=t,C(t*n,r))),s),r);return t.reduceRight(((t,n,i)=>n===o?t:(e[i]=C(t*e[i],r),C(t*n,r))),n),e}(t.map((t=>t.z)));return t.map(((t,e)=>t.toAffine(r[e])))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){w(t);const{x:r,y:e,z:n}=this,{x:i,y:o,z:s}=t,a=C(r*s),f=C(i*n),u=C(e*s),h=C(o*n);return a===f&&u===h}negate(){return new v(C(-this.x),this.y,this.z,C(-this.t))}double(){const{x:t,y:r,z:e}=this,{a:n}=h,i=C(t*t),o=C(r*r),s=C(a*C(e*e)),f=C(n*i),u=t+r,c=C(C(u*u)-i-o),l=f+o,p=l-s,d=f-o,y=C(c*p),g=C(l*d),m=C(c*d),w=C(p*l);return new v(y,g,w,m)}add(t){w(t);const{x:r,y:e,z:n,t:i}=this,{x:s,y:f,z:u,t:h}=t,c=C((e-r)*(f+s)),l=C((e+r)*(f-s)),p=C(l-c);if(p===o)return this.double();const d=C(n*a*h),y=C(i*a*u),g=y+d,m=l+c,b=y-d,E=C(g*p),S=C(m*b),x=C(g*b),B=C(p*m);return new v(E,S,B,x)}subtract(t){return this.add(t.negate())}precomputeWindow(t){const r=1+256/t,e=[];let n=this,i=n;for(let o=0;o<r;o++){i=n,e.push(i);for(let r=1;r<2**(t-1);r++)i=i.add(n),e.push(i);n=i.double()}return e}wNAF(t,r){!r&&this.equals(v.BASE)&&(r=B.BASE);const e=r&&r._WINDOW_SIZE||1;if(256%e)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&x.get(r);n||(n=this.precomputeWindow(e),r&&1!==e&&(n=v.normalizeZ(n),x.set(r,n)));let i=v.ZERO,o=v.BASE;const a=1+256/e,f=2**(e-1),u=BigInt(2**e-1),h=2**e,c=BigInt(e);for(let l=0;l<a;l++){const r=l*f;let e=Number(t&u);t>>=c,e>f&&(e-=h,t+=s);const a=r,p=r+Math.abs(e)-1,d=l%2!==0,y=e<0;0===e?o=o.add(m(d,n[a])):i=i.add(m(y,n[p]))}return v.normalizeZ([i,o])[0]}multiply(t,r){return this.wNAF(z(t,h.l),r)}multiplyUnsafe(t){let r=z(t,h.l,!1);const e=v.BASE,n=v.ZERO;if(r===o)return n;if(this.equals(n)||r===s)return this;if(this.equals(e))return this.wNAF(r);let i=n,a=this;for(;r>o;)r&s&&(i=i.add(a)),a=a.double(),r>>=s;return i}isSmallOrder(){return this.multiplyUnsafe(h.h).equals(v.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(h.l/a).double();return h.l%a&&(t=t.add(this)),t.equals(v.ZERO)}toAffine(t){const{x:r,y:e,z:n}=this,i=this.equals(v.ZERO);null==t&&(t=i?f:M(n));const o=C(r*t),a=C(e*t),u=C(n*t);if(i)return B.ZERO;if(u!==s)throw new Error("invZ was invalid");return new B(o,a)}fromRistrettoBytes(){E()}toRistrettoBytes(){E()}fromRistrettoHash(){E()}}function m(t,r){const e=r.negate();return t?e:r}function w(t){if(!(t instanceof v))throw new TypeError("ExtendedPoint expected")}function b(t){if(!(t instanceof S))throw new TypeError("RistrettoPoint expected")}function E(){throw new Error("Legacy method: switch to RistrettoPoint")}v.BASE=new v(h.Gx,h.Gy,s,C(h.Gx*h.Gy)),v.ZERO=new v(o,s,s,o);class S{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){const{d:r}=h,e=C(l*t*t),n=C((e+s)*y);let i=BigInt(-1);const o=C((i-r*e)*C(e+r));let{isValid:a,value:f}=q(n,o),u=C(f*t);L(u)||(u=C(-u)),a||(f=u),a||(i=e);const c=C(i*(e-s)*g-o),d=f*f,m=C((f+f)*o),w=C(c*p),b=C(s-d),E=C(s+d);return new v(C(m*E),C(b*w),C(w*E),C(m*b))}static hashToCurve(t){const r=P((t=Z(t,64)).slice(0,32)),e=this.calcElligatorRistrettoMap(r),n=P(t.slice(32,64)),i=this.calcElligatorRistrettoMap(n);return new S(e.add(i))}static fromHex(t){t=Z(t,32);const{a:r,d:e}=h,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=P(t);if(!function(t,r){if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0}(U(i),t)||L(i))throw new Error(n);const a=C(i*i),f=C(s+r*a),u=C(s-r*a),c=C(f*f),l=C(u*u),p=C(r*e*c-l),{isValid:d,value:y}=H(C(p*l)),g=C(y*u),m=C(y*g*p);let w=C((i+i)*g);L(w)&&(w=C(-w));const b=C(f*m),E=C(w*b);if(!d||L(E)||b===o)throw new Error(n);return new S(new v(w,b,s,E))}toRawBytes(){let{x:t,y:r,z:e,t:n}=this.ep;const i=C(C(e+r)*C(e-r)),o=C(t*r),s=C(o*o),{value:a}=H(C(i*s)),f=C(a*i),u=C(a*o),h=C(f*u*n);let c;if(L(n*h)){let e=C(r*l),n=C(t*l);t=e,r=n,c=C(f*d)}else c=u;L(t*h)&&(r=C(-r));let p=C((e-r)*c);return L(p)&&(p=C(-p)),U(p)}toHex(){return I(this.toRawBytes())}toString(){return this.toHex()}equals(t){b(t);const r=this.ep,e=t.ep,n=C(r.x*e.y)===C(r.y*e.x),i=C(r.y*e.y)===C(r.x*e.x);return n||i}add(t){return b(t),new S(this.ep.add(t.ep))}subtract(t){return b(t),new S(this.ep.subtract(t.ep))}multiply(t){return new S(this.ep.multiply(t))}multiplyUnsafe(t){return new S(this.ep.multiplyUnsafe(t))}}S.BASE=new S(v.BASE),S.ZERO=new S(v.ZERO);const x=new WeakMap;class B{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,x.delete(this)}static fromHex(t,r=!0){const{d:e,P:n}=h,i=(t=Z(t,32)).slice();i[31]=-129&t[31];const o=O(i);if(r&&o>=n)throw new Error("Expected 0 < hex < P");if(!r&&o>=c)throw new Error("Expected 0 < hex < 2**256");const a=C(o*o),f=C(a-s),u=C(e*a+s);let{isValid:l,value:p}=q(f,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const d=(p&s)===s;return 0!==(128&t[31])!==d&&(p=C(-p)),new B(p,o)}static async fromPrivateKey(t){return(await G(t)).point}toRawBytes(){const t=U(this.y);return t[31]|=this.x&s?128:0,t}toHex(){return I(this.toRawBytes())}toX25519(){const{y:t}=this;return U(C((s+t)*M(s-t)))}isTorsionFree(){return v.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new B(C(-this.x),this.y)}add(t){return v.fromAffine(this).add(v.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return v.fromAffine(this).multiply(t,this).toAffine()}}B.BASE=new B(h.Gx,h.Gy),B.ZERO=new B(o,s);function A(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===t.length)return t[0];const r=t.reduce(((t,r)=>t+r.length),0),e=new Uint8Array(r);for(let n=0,i=0;n<t.length;n++){const r=t[n];e.set(r,i),i+=r.length}return e}const T=Array.from({length:256},((t,r)=>r.toString(16).padStart(2,"0")));function I(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let r="";for(let e=0;e<t.length;e++)r+=T[t[e]];return r}function R(t){if("string"!==typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const r=new Uint8Array(t.length/2);for(let e=0;e<r.length;e++){const n=2*e,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[e]=o}return r}function D(t){return R(t.toString(16).padStart(64,"0"))}function U(t){return D(t).reverse()}function L(t){return(C(t)&s)===s}function O(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+I(Uint8Array.from(t).reverse()))}const N=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function P(t){return C(O(t)&N)}function C(t,r=h.P){const e=t%r;return e>=o?e:r+e}function M(t,r=h.P){if(t===o||r<=o)throw new Error(`invert: expected positive integers, got n=${t} mod=${r}`);let e=C(t,r),n=r,i=o,a=s,f=s,u=o;for(;e!==o;){const t=n/e,r=n%e,o=i-f*t,s=a-u*t;n=e,e=r,i=f,a=u,f=o,u=s}if(n!==s)throw new Error("invert: does not exist");return C(i,r)}function _(t,r){const{P:e}=h;let n=t;for(;r-- >o;)n*=n,n%=e;return n}function k(t){const{P:r}=h,e=BigInt(5),n=BigInt(10),i=BigInt(20),o=BigInt(40),f=BigInt(80),u=t*t%r*t%r,c=_(u,a)*u%r,l=_(c,s)*t%r,p=_(l,e)*l%r,d=_(p,n)*p%r,y=_(d,i)*d%r,g=_(y,o)*y%r,v=_(g,f)*g%r,m=_(v,f)*g%r,w=_(m,n)*p%r;return{pow_p_5_8:_(w,a)*t%r,b2:u}}function q(t,r){const e=C(r*r*r),n=C(e*e*r);let i=C(t*e*k(t*n).pow_p_5_8);const o=C(r*i*i),s=i,a=C(i*l),f=o===t,u=o===C(-t),h=o===C(-t*l);return f&&(i=s),(u||h)&&(i=a),L(i)&&(i=C(-i)),{isValid:f||u,value:i}}function H(t){return q(s,t)}function F(t){return C(O(t),h.l)}function Z(t,r){const e=t instanceof Uint8Array?Uint8Array.from(t):R(t);if("number"===typeof r&&e.length!==r)throw new Error(`Expected ${r} bytes`);return e}function z(t,r,e=!0){if(!r)throw new TypeError("Specify max value");if("number"===typeof t&&Number.isSafeInteger(t)&&(t=BigInt(t)),"bigint"===typeof t&&t<r)if(e){if(o<t)return t}else if(o<=t)return t;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function V(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function j(t){if(32!==(t="bigint"===typeof t||"number"===typeof t?D(z(t,c)):Z(t)).length)throw new Error("Expected 32 bytes");return t}function K(t){const r=V(t.slice(0,32)),e=t.slice(32,64),n=F(r),i=B.BASE.multiply(n),o=i.toRawBytes();return{head:r,prefix:e,scalar:n,point:i,pointBytes:o}}let W;async function G(t){return K(await J.sha512(j(t)))}B.BASE._setWindowSize(8);const $={node:n||(n=e.t(i,2)),web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},J={bytesToHex:I,hexToBytes:R,concatBytes:A,getExtendedPublicKey:G,mod:C,invert:M,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if((t=Z(t)).length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return C(O(t),h.l-s)+s},randomBytes:(t=32)=>{if($.web)return $.web.getRandomValues(new Uint8Array(t));if($.node){const{randomBytes:r}=$.node;return new Uint8Array(r(t).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>J.randomBytes(32),sha512:async(...t)=>{const r=A(...t);if($.web){const t=await $.web.subtle.digest("SHA-512",r.buffer);return new Uint8Array(t)}if($.node)return Uint8Array.from($.node.createHash("sha512").update(r).digest());throw new Error("The environment doesn't have sha512 function")},precompute(t=8,r=B.BASE){const e=r.equals(B.BASE)?r:new B(r.x,r.y);return e._setWindowSize(t),e.multiply(a),e},sha512Sync:void 0};Object.defineProperties(J,{sha512Sync:{configurable:!1,get:()=>W,set(t){W||(W=t)}}})}}]);